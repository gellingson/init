{% extends "listings/listingsbase.html" %}
{% load staticfiles %}
{% block title %}Carbyr: beta interface{% endblock %}
	{% block navbar %}
	<div class="navbar navbar-fixed-top navbar-default" role="navigation">
	  <div class="container">
		<div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
			<span class="sr-only">Toggle navigation</span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		  </button>
		  <div class="navbar-brand">
			<a href="/cars/">
			  <picture>
				<source srcset="carbyr-logo-70px 1x, carbyr-logo-70px-2x.png 2x">
				<img src="{% static 'listings/images/carbyr-logo-70px.png' %}" alt="Carbyr">
			  </picture>
			</a>
		  </div>
		  <div class="navbar-slogan">
			Cars for enthusiasts...
		  </div>
		</div>
		<div class="navbar-collapse collapse">
		  <ul class="nav navbar-nav navbar-right">
			<li><a href="/about">Login</a></li>
			<li><a href="/about">About Carbyr</a></li>
		  </ul>
		</div>
	  </div>
	</div>
	{% endblock navbar %}
  	{% block header %}
	  <div class="page-header">
		{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
		<form class="searchform" role="form" action="{{ abs_url }}" method="get">
		  {% csrf_token %}
		  <div class="form-group">
			<div class="input-group input-group-moves">
			  <a class="btn btn-info fixed-150" id="MSOButton">More Options</a>
			</div>
			<div class="input-group">
			  <label class="sr-only" for="search_string">Search criteria:</label>
			  <input type="text" placeholder="find me..." class="form-control" name="search_string" id="search_string"/>
			  <span class="input-group-btn">
				<button type="submit" class="btn btn-success">Search</button>
			  </span>
			</div>
		  </div>
		  <div class="input-group form-inline toolbox-container hidden toolbox-row" id="MSOPanel">
			<div class="col-sm-4">
			  <input type="checkbox" class="checkbox-inline" name="limit" id="limit">
			  <label for="limit" class="label-between">Limit to cars near</label>
			  <label for="zip" class="sr-only">zipcode</label>
 			  <input type="text" class="zip" placeholder="zip code" class="form-control" name="zip" id="zip" size="20"/>
			</div>
			<div class="col-sm-4">
			  <input type="checkbox" class="checkbox-inline" name="picreqd" id="picreqd">
			  <label for="picreqd" class="label-between">Listings with photos only</label>
			</div>
			<div class="col-sm-4">
			  <label for="yearfrom" class="label-between">Model year</label>
			  <input type="text" class="shortbox" id="yearfrom"/>
			  <label for="yearto" class="label-between">to</label>
			  <input type="text" class="shortbox" id="yearto"/>
			</div>
		  </div>
		  <div class="toolbox">
			<h5>My Searches</h5>
			{% if recents %}
			{% for search in recents %}
			<a class="btn btn-default" href="{{ abs_url }}s/{{ search.id }}/"><span class="glyphicon glyphicon-time"></span>{{ search.desc }}</a>
			{% endfor %}
			{% endif %}
			{% if more_recents %}
			<div class="btn-group">
			  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
				More Recents... <span class="caret"></span>
			  </button>
			  <ul class="dropdown-menu" role="menu">
				{% for search in more_recents %}
				<li><a href="{{ abs_url }}?s={{ search.id }}">{{ search.desc }}</a></li>
				{% endfor %}
			  </ul>
			</div>
			{% endif %}
			{% if favorites %}
			{% for search in favorites %}
			<a class="btn btn-default" href="{{ abs_url }}s/{{ search.id }}/"><span class="glyphicon glyphicon-heart"></span>{{ search.desc }}</a>
			{% endfor %}
			{% endif %}
			{% if suggestions %}
			{% for search in suggestions %}
			<a class="btn btn-default" href="{{ abs_url }}s/{{ search.id }}/"><span class="glyphicon glyphicon-ok-circle"></span>{{ search.desc }}</a>
			{% endfor %}
			{% endif %}
		  </div>
		</form>
		<div class="row header-row">
		  <p class="float-left" id="showing">
			{% if search_type == 'F' %}Favorite search:{% else %}Showing:{% endif %} {{ search_desc }}
		  </p>
		  <p class="float-right">
			{% if search_id %}
			{% if search_type == 'F' %}
			<button class="btn-link" data-toggle="modal" data-target="#unSaveModal">
			  <span class="glyphicon glyphicon-minus"></span>Remove <span class="long">this from your list of favorites</span>
			</button>
			{% elif search_type != 'D' %}
			<button class="btn-link" data-toggle="modal" data-target="#saveModal">
			  <span class="glyphicon glyphicon-plus"></span>Save <span class="long">this search as a favorite</span>
			</button>
			{% endif %}
			{% endif %}
		  </p>
		</div>
	  </div>
  	  {% endblock header %}
{% block scripts %}
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script src="{% static 'listings/js/bootstrap.min.js' %}"></script>
	<script src="{% static 'listings/js/listings.js' %}"></script>
<div class="modal fade" id="saveModal" tabindex="-1" role="dialog" aria-labelledby="saveModalLabel" aria-hidden="true">
  <div class="modal-dialog">
	<div class="modal-content">
	  <div class="modal-header">
		<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		<h4 class="modal-title" id="saveModalLabel">Save this as a favorite search</h4>
	  </div>
	  <div class="modal-body">
		<p>Favorite searches make it easy to manage your car search. As suitable cars enter (and leave) the market this list will automatically update; check back any time. </p>
		<p>You can also choose to receive updates on saved searches through RSS or email [coming soon!].</p>
	  </div>
	  <form role="form" action="{{ abs_url }}" method="post">
		{% csrf_token %}
			<input type="hidden" name="save_id" value="{{ search_id }}">
			<div class="modal-thingy">
			  <label class="modal-label" for="save_desc">Name the search:</label>
			  <input type="text" value="{{ search_desc }}" name="save_desc" id="save_desc"/>
			</div>
		<div class="modal-footer">
		  <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
		  <button type="submit" class="btn btn-primary">Save</button>
		</div>
	  </form>		
	</div>
  </div>
</div>
<div class="modal fade" id="unSaveModal" tabindex="-1" role="dialog" aria-labelledby="unSaveModalLabel" aria-hidden="true">
  <div class="modal-dialog">
	<div class="modal-content">
	  <div class="modal-header">
		<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
		<h4 class="modal-title" id="unSaveModalLabel">Confirm</h4>
	  </div>
	  <div class="modal-body">
		<p>Confirm removing favorite search: {{ search_desc }}? </p>
	  </div>
	  <form role="form" action="{{ abs_url }}" method="post">
		{% csrf_token %}
			<input type="hidden" name="unsave_id" value="{{ search_id }}">
		<div class="modal-footer">
		  <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
		  <button type="submit" class="btn btn-primary">Confirm</button>
		</div>
	  </form>		
	</div>
  </div>
</div>
{% endblock scripts %}
